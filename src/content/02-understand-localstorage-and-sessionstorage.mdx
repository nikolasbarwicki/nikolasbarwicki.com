---
title: "LocalStorage i SessionStorage?"
slug: localstorage-sessionstorage
date: 2021-03-21
category: javascript
published: true
---

## Przechowywanie danych w przeglÄ…darce

ZarÃ³wno `localStorage` jak i `sessionStorage` sÄ… czÄ™sciami [Web Storage API](https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API) i sÅ‚uÅ¼Ä… do zapisywania _key/value pairs_ lokalnie w przeglÄ…darce. Dane zapisane w obu tych miejscach nie zostanÄ… wymazane po refreshu strony (dla `sessionStorage`) a nawet po restercie przeglararki (`localStorage`). Mamy ciasteczka wiÄ™c po co ich uÅ¼ywaÄ‡? Poznajmy trzy podstawowe zalety `localStorage`/`sessionStorage` nad ciastkami:

- **dane przechowujemy lokalnie** i nie wysyÅ‚amy ich przy kaÅ¼dym zapytaniu w headerze do serwera, jest to poÅ¼Ä…dane z punktu widzenia bezpieczeÅ„stwa a takÅ¼e bezpoÅ›rednio wiÄ…Å¼e siÄ™ z podpunktem nastÄ™pnym,
- dzieki temu, Å¼e nie wysyÅ‚amy tych danych przy kaÅ¼dym zapytaniu moÅ¼emy zapisywaÄ‡ **do 10mb danych** w przypadku wiekszoÅ›ci przeglÄ…darek,
- API jset **Å‚atwe do zrozumienia** w krÃ³tkim czasie i do prostego wykorzystania w projektach

W tej sytuacji ciasteczka sÄ… ewidentnie na przegranej pozycji. Jednak pozostajÄ… one nadal uÅ¼yteczne w szczegÃ³lnoÅ›ci do wszystkich operacji zwiazacnych z uwierzytelnieniem - o tym w innym artykule.

## Local i Session

Oba majÄ… te samo API i ich wykorzystanie wyglÄ…da praktycznie idetnczynie. Przy wyborze jednego z nich bierzemy pod uwagÄ™ jak dÅ‚ugo potrzebujemy przetrzymywaÄ‡ zapisane dane. Reszta artykuÅ‚u bÄ™dzie zawieraÄ‡ przykÅ‚ady dla `localStorage` ale warto pamietaÄ‡, Å¼e zastosowanie ich z sessionStorage jest idetyczne. Dane zapisane w `localStorage` sÄ… dostÄ™pne w przeglÄ…darce pomiÄ™dzy wszystkimi kartami i oknami pod warunkiem, Å¼e pochodzÄ… z tego samego _origin_ - jeÅ›li dokonaÅ‚y zmiany w jednym oknie (na tym samym _origin_ - Å›cieÅ¼ka moÅ¼e byÄ‡ inna) to zmiany te bÄ™dÄ… widoczne w innym.

## Dodawanie i odczytywanie

W celu utworzenia nowego wpisu w `localStorage` uÅ¼ywamy metody `setItem()`. Metoda `setItem()` przyjmuje dwa argumenty, klucz i odpowiadajÄ…ca mu wartoÅ›Ä‡:

```javascript
localStorage.setItem("kangur", "ğŸ¦˜")
```

W celu odczytania wartoÅ›ci uÅ¼ywamy metody `getItem()`. Przyjmuje ona jeden argument bÄ™dÄ…cy wczesniej uÅ¼ytym kluczem. Zwraca ona odpowiadajÄ…cÄ… kluczowi wartoÅ›Ä‡ w formie stringa.

```javascript
const myItem = localStorage.getItem("kangur")

// myItem = "ğŸ¦˜"
```

## Aktualizacja i usuwanie wartoÅ›ci

Aby zaktualizowaÄ‡ wartoÅ›Ä‡ zapisanÄ… w `localStorage` uzywamy tej samej metody co w przypadku tworzenia nowego wpisu - stosujemy ten sam klucz, zaÅ› zmieniamy argument zawierajÄ…cy nowÄ… wartoÅ›Ä‡.

```javascript
localStorage.setItem("kangur", "ğŸ¼")

// myItem = "ğŸ¼"
```

MoÅ¼emy usunÄ…Ä‡ wartoÅ›ci z `localStorage` dwiema metodami. Przy uÅ¼yciu `removeItem()` ktora przyjmuje jeden argument bÄ™dacy kluczem obiektu `localStorage`:

```javascript
localStorage.removeItem(key)
```

Lub usunÄ…Ä‡ wszystkie items znajdujace sie w `localStorage` przy uÅ¼yciu `clear()`.

```javascript
localStorage.clear()
```

## Przechowywanie nietypowych danych

Przy uzyciu `localStorage` mozemy przechowywac jedynie wartoÅ›ci typu _string_. CzÄ™sto bedziemy spotykaÄ‡ sie z sytuacja w ktorej chcemy przchowac cale obiekty z danymi. Mozemy to zrobiÄ‡ przy uÅ¼yciu metod `JSON.stringify()` oraz `JSON.parse()` w nastepujacy sposob:

W celu dodania lub aktualizacji:

```javascript
let myObj = { kraj: "ğŸ‡®ğŸ‡¹", danie: "ğŸ•" }
localStorage.setItem(key, JSON.stringify(myObj))
```

DziÄ™ki temu temu `myObj` zostaÅ‚ zapisany w `localStorage` jako _string_, a nie jako obiekt. Ze wzglÄ™du na to aby ponownie uÅ¼yÄ‡ tego obiektu musimy z powrotem przywrocic go do typu obiketu:

```javascript
let item = JSON.parse(localStorage.getItem(key))

// item = { kraj: "ğŸ‡®ğŸ‡¹", danie: "ğŸ•" }
```

DziÄ™ki temu zmienna `item` przyjÄ™Å‚a wartoÅ›Ä‡ obiektu `key` i jest typu obiektu i moÅ¼emy przeprowadzaÄ‡ na niej operacje, ktÃ³re moÅ¼emy wykonywaÄ‡ na obiektach JS.

## Sprawdzanie

Czasami moÅ¼e siÄ™ okazaÄ‡ Å¼e musimy sprawdziÄ‡ czy posiadamy przypisane wartosci do `localStorage`. W tym celu mozemy uÅ¼yÄ‡ zapisu:

```javascript
if (localStorage.length > 0) {
  // ...
}
```

Jesli w `localStorage` znajduje sie choÄ‡ jeden element _if_ zwrÃ³ci `true`. `localStorage.length` informuje nas o liczbie zapisanych elementÃ³w.

## Podsumowanie

ZarÃ³wno `localStorage`, jak i `sessionStorage` pozwalajÄ… nam na przechowywanie par klucz/wartoÅ›Ä‡ w przeglÄ…darce.

- klucz jak i wartoÅ›Ä‡ muszÄ… byÄ‡ typu _string_
- rozmiar zapisanych danych wynosi ponad 5mb
- nie tracÄ… waÅ¼noÅ›ci
- dane sÄ… powiÄ…zane z _origin_

`localStorage` - wspÃ³Å‚dzielone pomiÄ™dzy wszystkimi kartami i oknami pochodzÄ…cymi z tego samego _origin_, nie jest zerowane po restarcie przeglÄ…darki

`sessionStorage` - dostÄ™pne wewnatrz karty przeglÄ…darki z tego samego _origin_, nie jest zerowane po przeÅ‚adowaniu strony lecz po zamkniÄ™ciu karty.
